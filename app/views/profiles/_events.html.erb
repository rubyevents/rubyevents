<%# Event Participations %>

<% cache [user, events, Current.user] do %>
  <input type="radio" name="talk_tabs" role="tab" class="tab px-6" aria-label="Event participations (<%= events.size %>)" <%= "checked" if talks.size.zero? %>>

  <div role="tabpanel" class="tab-content mt-6">
    <div class="space-y-8">
      <% participated_events_by_type.each do |participation_type, events| %>
        <div>
          <h3 class="text-lg font-semibold mb-4">
            <%= t("event_participation.attended_as.#{participation_type}", default: participation_type.humanize) %>
          </h3>
          <div class="mb-6">
            <div class="grid min-w-full grid-cols-1 gap-8 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
              <%= cache events do %>
                <%= render partial: "events/card", collection: events, as: :event, cached: true %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>

      <div class="text-center py-12 hidden only:block">
        <div class="mb-6">
          <h3 class="text-lg font-semibold text-gray-900 mb-2">No participated events yet</h3>
          <p class="text-gray-600 mb-6 max-w-xl mx-auto">
            <% if Current.user == user %>
              You haven't marked your participation in any events yet. Visit <%= link_to "event pages", events_path, class: "link link-primary link-ghost" %> or search events with <kbd class="kbd kbd-sm text-base-content">âŒ˜ k</kbd> and click "Add to My Events" to start building your event history.
            <% elsif Current.user %>
              This user hasn't marked their participation in any events yet.
            <% else %>
              Sign in to manage your profile and mark your participation in events you've attended.
            <% end %>
          </p>
        </div>

        <% if Current.user && Current.user == user %>
          <div class="space-y-3">
            <%= link_to events_path, class: "btn btn-primary" do %>
              <%= fa("magnifying-glass", style: :regular) %>
              Browse Events
            <% end %>
          </div>
        <% elsif !Current.user %>
          <div class="space-y-3">
            <%= link_to "Sign in", new_session_path(redirect_to: request.fullpath), data: {turbo_frame: "modal"}, class: "btn btn-primary" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
