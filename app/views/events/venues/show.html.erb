<%= render partial: "events/header", locals: {event: @event} %>

<%= turbo_frame_tag dom_id(@event), data: {turbo_action: "advance", turbo_frame: "_top"} do %>
  <div class="container py-8">
    <%= render partial: "events/navigation", locals: {event: @event} %>

    <div class="flex flex-col gap-8 mt-8">
      <section class="bg-white rounded-lg border p-6 shadow-sm">
        <div class="flex flex-col md:flex-row gap-6">
          <div class="flex-1">
            <h2 class="text-2xl font-bold text-gray-900 mb-2"><%= @venue.name %></h2>

            <% if @venue.display_address.present? %>
              <p class="text-gray-600 mb-2"><%= @venue.display_address %></p>
            <% end %>

            <% if @venue.description.present? %>
              <p class="text-gray-600 mb-4 whitespace-pre-line"><%= @venue.description %></p>
            <% end %>

            <% if @venue.instructions.present? %>
              <div class="mt-4">
                <h3 class="font-semibold text-gray-800 mb-2">Getting There</h3>
                <p class="text-gray-600 whitespace-pre-line"><%= @venue.instructions %></p>
              </div>
            <% end %>

            <% if @venue.maps.any? || @venue.url.present? %>
              <div class="flex flex-wrap gap-2 mt-4">
                <% if @venue.url.present? %>
                  <%= link_to @venue.url, target: "_blank", rel: "noopener", class: "btn btn-sm btn-outline gap-2" do %>
                    <%= fa("square-arrow-up-right", size: :sm, style: :solid) %>
                    Website
                  <% end %>
                <% end %>

                <% if @venue.google_maps_url.present? %>
                  <%= link_to @venue.google_maps_url, target: "_blank", rel: "noopener", class: "btn btn-sm btn-outline gap-2" do %>
                    <%= fa("map-location", size: :sm, style: :solid) %>
                    Google Maps
                  <% end %>
                <% end %>

                <% if @venue.apple_maps_url.present? %>
                  <%= link_to @venue.apple_maps_url, target: "_blank", rel: "noopener", class: "btn btn-sm btn-outline gap-2" do %>
                    <%= fa("map-location", size: :sm, style: :solid) %>
                    Apple Maps
                  <% end %>
                <% end %>

                <% if @venue.openstreetmap_url.present? %>
                  <%= link_to @venue.openstreetmap_url, target: "_blank", rel: "noopener", class: "btn btn-sm btn-outline gap-2" do %>
                    <%= fa("map-location", size: :sm, style: :solid) %>
                    OpenStreetMap
                  <% end %>
                <% end %>
              </div>
            <% end %>
          </div>
        </div>
      </section>

      <% if @venue.map_markers.any? %>
        <section class="bg-white rounded-lg border shadow-sm overflow-hidden">
          <div
            id="venue-map"
            class="w-full h-[400px] md:h-[500px]"
            data-controller="map"
            data-map-mode-value="venue"
            data-map-markers-value="<%= @venue.map_markers.to_json %>"></div>
        </section>
      <% end %>

      <% if @venue.rooms.any? %>
        <section class="bg-white rounded-lg border p-6 shadow-sm">
          <h3 class="text-xl font-bold text-gray-900 mb-4">Rooms</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <% @venue.rooms.each do |room| %>
              <div class="border rounded-lg p-4">
                <h4 class="font-semibold text-gray-900"><%= room["name"] %></h4>
                <% if room["floor"].present? %>
                  <p class="text-sm text-gray-500"><%= room["floor"] %></p>
                <% end %>
                <% if room["capacity"].present? %>
                  <p class="text-sm text-gray-500">Capacity: <%= room["capacity"] %></p>
                <% end %>
                <% if room["instructions"].present? %>
                  <p class="text-sm text-gray-600 mt-2"><%= room["instructions"] %></p>
                <% end %>
              </div>
            <% end %>
          </div>
        </section>
      <% end %>

      <% if @venue.spaces.any? %>
        <section class="bg-white rounded-lg border p-6 shadow-sm">
          <h3 class="text-xl font-bold text-gray-900 mb-4">Other Spaces</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <% @venue.spaces.each do |space| %>
              <div class="border rounded-lg p-4">
                <h4 class="font-semibold text-gray-900"><%= space["name"] %></h4>
                <% if space["floor"].present? %>
                  <p class="text-sm text-gray-500"><%= space["floor"] %></p>
                <% end %>
                <% if space["instructions"].present? %>
                  <p class="text-sm text-gray-600 mt-2"><%= space["instructions"] %></p>
                <% end %>
              </div>
            <% end %>
          </div>
        </section>
      <% end %>

      <% if @venue.accessibility.any? %>
        <section class="bg-white rounded-lg border p-6 shadow-sm">
          <h3 class="text-xl font-bold text-gray-900 mb-4">Accessibility</h3>
          <div class="flex flex-wrap gap-3">
            <% if @venue.accessibility["wheelchair"] %>
              <span class="badge badge-lg badge-success gap-2">
                <%= fa("circle-check", size: :xs, style: :solid, class: "fill-green-700") %>
                Wheelchair Accessible
              </span>
            <% end %>
            <% if @venue.accessibility["elevators"] %>
              <span class="badge badge-lg badge-success gap-2">
                <%= fa("circle-check", size: :xs, style: :solid, class: "fill-green-700") %>
                Elevators
              </span>
            <% end %>
            <% if @venue.accessibility["accessible_restrooms"] %>
              <span class="badge badge-lg badge-success gap-2">
                <%= fa("circle-check", size: :xs, style: :solid, class: "fill-green-700") %>
                Accessible Restrooms
              </span>
            <% end %>
          </div>
          <% if @venue.accessibility["notes"].present? %>
            <p class="text-gray-600 mt-4"><%= @venue.accessibility["notes"] %></p>
          <% end %>
        </section>
      <% end %>

      <% if @venue.nearby.any? %>
        <section class="bg-white rounded-lg border p-6 shadow-sm">
          <h3 class="text-xl font-bold text-gray-900 mb-4">Nearby</h3>
          <dl class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <% if @venue.nearby["public_transport"].present? %>
              <div>
                <dt class="font-semibold text-gray-700">Public Transport</dt>
                <dd class="text-gray-600"><%= @venue.nearby["public_transport"] %></dd>
              </div>
            <% end %>
            <% if @venue.nearby["parking"].present? %>
              <div>
                <dt class="font-semibold text-gray-700">Parking</dt>
                <dd class="text-gray-600"><%= @venue.nearby["parking"] %></dd>
              </div>
            <% end %>
          </dl>
        </section>
      <% end %>

      <% if @venue.locations.any? %>
        <section class="bg-white rounded-lg border p-6 shadow-sm">
          <h3 class="text-xl font-bold text-gray-900 mb-4">Other Locations</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <% @venue.locations.each do |location| %>
              <div class="border rounded-lg p-4">
                <div class="flex items-start justify-between gap-2">
                  <h4 class="font-semibold text-gray-900"><%= location["name"] %></h4>
                  <% if location["kind"].present? %>
                    <span class="badge badge-sm badge-primary shrink-0"><%= location["kind"] %></span>
                  <% end %>
                </div>
                <% if location["address"].present? %>
                  <p class="text-sm text-gray-500 mt-1"><%= location["address"] %></p>
                <% end %>
                <% if location["description"].present? %>
                  <p class="text-sm text-gray-600 mt-2"><%= location["description"] %></p>
                <% end %>
                <% if location["distance"].present? %>
                  <p class="text-xs text-gray-500 mt-2"><%= location["distance"] %></p>
                <% end %>
                <div class="flex flex-wrap gap-2 mt-3">
                  <% if location.dig("maps", "google").present? %>
                    <%= link_to location.dig("maps", "google"), target: "_blank", rel: "noopener", class: "btn btn-xs btn-outline" do %>
                      <%= fa("map-location", size: :xs, style: :solid) %>
                      Google
                    <% end %>
                  <% end %>
                  <% if location.dig("maps", "apple").present? %>
                    <%= link_to location.dig("maps", "apple"), target: "_blank", rel: "noopener", class: "btn btn-xs btn-outline" do %>
                      <%= fa("map-location", size: :xs, style: :solid) %>
                      Apple
                    <% end %>
                  <% end %>
                  <% if location["url"].present? %>
                    <%= link_to location["url"], target: "_blank", rel: "noopener", class: "btn btn-xs btn-outline" do %>
                      <%= fa("square-arrow-up-right", size: :xs, style: :solid) %>
                      Website
                    <% end %>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        </section>
      <% end %>

      <% if @venue.hotels.any? %>
        <section class="bg-white rounded-lg border p-6 shadow-sm">
          <h3 class="text-xl font-bold text-gray-900 mb-4">Recommended Hotels</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <% @venue.hotels.each do |hotel| %>
              <div class="border rounded-lg p-4">
                <div class="flex items-start justify-between gap-2">
                  <h4 class="font-semibold text-gray-900"><%= hotel["name"] %></h4>
                  <% if hotel["kind"].present? %>
                    <span class="badge badge-sm badge-outline shrink-0"><%= hotel["kind"] %></span>
                  <% end %>
                </div>
                <% if hotel["address"].present? %>
                  <p class="text-sm text-gray-500 mt-1"><%= hotel["address"] %></p>
                <% end %>
                <% if hotel["description"].present? %>
                  <p class="text-sm text-gray-600 mt-2"><%= hotel["description"] %></p>
                <% end %>
                <% if hotel["distance"].present? %>
                  <p class="text-xs text-gray-500 mt-2"><%= hotel["distance"] %></p>
                <% end %>
                <div class="flex flex-wrap gap-2 mt-3">
                  <% if hotel.dig("maps", "google").present? %>
                    <%= link_to hotel.dig("maps", "google"), target: "_blank", rel: "noopener", class: "btn btn-xs btn-outline" do %>
                      <%= fa("map-location", size: :xs, style: :solid) %>
                      Google
                    <% end %>
                  <% end %>
                  <% if hotel.dig("maps", "apple").present? %>
                    <%= link_to hotel.dig("maps", "apple"), target: "_blank", rel: "noopener", class: "btn btn-xs btn-outline" do %>
                      <%= fa("map-location", size: :xs, style: :solid) %>
                      Apple
                    <% end %>
                  <% end %>
                  <% if hotel["url"].present? %>
                    <%= link_to hotel["url"], target: "_blank", rel: "noopener", class: "btn btn-xs btn-outline" do %>
                      <%= fa("square-arrow-up-right", size: :xs, style: :solid) %>
                      Website
                    <% end %>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        </section>
      <% end %>
    </div>
  </div>
<% end %>
