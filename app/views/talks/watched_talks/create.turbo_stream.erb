<%
  video_provider = case @talk.video_provider
  when "mp4" then "mp4"
  when "parent" then @talk.parent_talk.video_provider
  else @talk.video_provider
  end

  video_provider = @talk.video_provider if @talk.parent_talk&.video_provider == "children"
  video_id = (@talk.video_provider == "parent") ? @talk.parent_talk.video_id : @talk.video_id
%>

<%= turbo_stream.update "modal" do %>
<% end %>

<%= turbo_stream.update dom_id(@talk, :video_player) do %>
  <%= render partial: "talks/video_player", locals: {talk: @talk, current_user_watched_talk: @watched_talk, is_watched: true, video_provider: video_provider, video_id: video_id} %>
<% end %>

<%= turbo_stream.update dom_id(@talk, :feedback_banner) do %>
  <%= render partial: "talks/watched_talks/feedback_banner", locals: {talk: @talk, watched_talk: @watched_talk} %>
<% end %>

<%= turbo_stream.update dom_id(@talk, :watched_button) do %>
  <%= render partial: "talks/watched_talks/button", locals: {talk: @talk, is_watched: true} %>
<% end %>
